# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏
$GitHubRepoUrl = "https://github.com/username/repository/raw/main/path/to/sound.wav"
$DownloadPath = "$env:TEMP\custom_startup.wav"
$RegistryPath = "HKCU:\AppEvents\Schemes\Apps\.Default\WindowsLogon\.Current"

function Download-File {
    param(
        [string]$Url,
        [string]$OutputPath
    )
    
    try {
        Write-Host "–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞..." -ForegroundColor Yellow
        Invoke-WebRequest -Uri $Url -OutFile $OutputPath -UserAgent "PowerShell"
        return $true
    }
    catch {
        Write-Host "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: $($_.Exception.Message)" -ForegroundColor Red
        return $false
    }
}

function Set-StartupSound {
    param(
        [string]$SoundPath
    )
    
    try {
        Set-ItemProperty -Path $RegistryPath -Name "(Default)" -Value $SoundPath -ErrorAction Stop
        return $true
    }
    catch {
        Write-Host "–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–µ—Å—Ç—Ä–∞: $($_.Exception.Message)" -ForegroundColor Red
        return $false
    }
}

# –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å
Write-Host "=== –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∑–≤—É–∫–∞ –∑–∞–ø—É—Å–∫–∞ ===" -ForegroundColor Green

# –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
if (Download-File -Url $GitHubRepoUrl -OutputPath $DownloadPath) {
    Write-Host "–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω: $DownloadPath" -ForegroundColor Green
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Ñ–∞–π–ª–∞
    if ((Get-Item $DownloadPath).Extension -ne ".wav") {
        Write-Host "–í–Ω–∏–º–∞–Ω–∏–µ: —Ñ–∞–π–ª –Ω–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ WAV!" -ForegroundColor Yellow
    }
    
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–≤—É–∫–∞
    if (Set-StartupSound -SoundPath $DownloadPath) {
        Write-Host "‚úÖ –ó–≤—É–∫ –∑–∞–ø—É—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω!" -ForegroundColor Green
        Write-Host "üîÑ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞..." -ForegroundColor Cyan
        Write-Host "üìÅ –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: $DownloadPath" -ForegroundColor Gray
        
        # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
        Write-Host "`n‚ö†Ô∏è  –ö–æ–º–ø—å—é—Ç–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥..." -ForegroundColor Yellow
        Write-Host "–î–ª—è –æ—Ç–º–µ–Ω—ã –Ω–∞–∂–º–∏—Ç–µ Ctrl+C" -ForegroundColor Yellow
        Start-Sleep -Seconds 10
        Restart-Computer -Force
    }
}
else {
    Write-Host "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≤–µ—Ä—à–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É" -ForegroundColor Red
}
